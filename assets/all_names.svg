<svg viewBox="0 0 808.65625 2544" style="max-width: 808.65625px;" aria-labelledby="chart-title-mermaid-svg chart-desc-mermaid-svg" role="img" xmlns="http://www.w3.org/2000/svg" width="100%" id="mermaid-svg"><title id="chart-title-mermaid-svg"></title><desc id="chart-desc-mermaid-svg"></desc><style>#mermaid-svg {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-svg .error-icon{fill:#552222;}#mermaid-svg .error-text{fill:#552222;stroke:#552222;}#mermaid-svg .edge-thickness-normal{stroke-width:2px;}#mermaid-svg .edge-thickness-thick{stroke-width:3.5px;}#mermaid-svg .edge-pattern-solid{stroke-dasharray:0;}#mermaid-svg .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-svg .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-svg .marker{fill:#333333;stroke:#333333;}#mermaid-svg .marker.cross{stroke:#333333;}#mermaid-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-svg .cluster-label text{fill:#333;}#mermaid-svg .cluster-label span{color:#333;}#mermaid-svg .label text,#mermaid-svg span{fill:#333;color:#333;}#mermaid-svg .node rect,#mermaid-svg .node circle,#mermaid-svg .node ellipse,#mermaid-svg .node polygon,#mermaid-svg .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-svg .node .label{text-align:center;}#mermaid-svg .node.clickable{cursor:pointer;}#mermaid-svg .arrowheadPath{fill:#333333;}#mermaid-svg .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-svg .flowchart-link{stroke:#333333;fill:none;}#mermaid-svg .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-svg .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-svg .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-svg .cluster text{fill:#333;}#mermaid-svg .cluster span{color:#333;}#mermaid-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-svg .empty&gt;*{width:0px!important;height:0px!important;}#mermaid-svg .empty span{width:0px!important;height:0px!important;}#mermaid-svg .code&gt;*{color:red!important;}#mermaid-svg .code span{color:red!important;}</style><g><g class="output"><g class="clusters"><g style="opacity: 1;" transform="translate(404.328125,1272)" id="flowchart-subGraph4-144" class="cluster"><rect y="-1264" x="-396.328125" height="2528" width="792.65625"></rect><g id="mermaid-svgText" transform="translate(0, -1250)" class="label"><g transform="translate(-93.5078125,-14)"><foreignObject height="28" width="187.015625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="font-size:24px">TransformerBlock</span></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(418.109375,289.5)" id="flowchart-subGraph0-148" class="cluster"><rect y="-123.5" x="-270.4921875" height="247" width="540.984375"></rect><g id="mermaid-svgText" transform="translate(0, -109.5)" class="label"><g transform="translate(-261.3125,-14)"><foreignObject height="28" width="522.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="font-size:24px">ln1                          </span></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(433.181640625,864.5)" id="flowchart-subGraph1-147" class="cluster"><rect y="-382.5" x="-347.474609375" height="765" width="694.94921875"></rect><g id="mermaid-svgText" transform="translate(0, -368.5)" class="label"><g transform="translate(-334.53125,-14)"><foreignObject height="28" width="669.0625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="font-size:24px">attn                                 </span></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(386.25390625,1755.5)" id="flowchart-subGraph2-146" class="cluster"><rect y="-123.5" x="-95.4140625" height="247" width="190.828125"></rect><g id="mermaid-svgText" transform="translate(0, -109.5)" class="label"><g transform="translate(-90.8515625,-14)"><foreignObject height="28" width="181.703125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="font-size:24px">ln2         </span></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(386.25390625,2071.5)" id="flowchart-subGraph3-145" class="cluster"><rect y="-123.5" x="-109.8125" height="247" width="219.625"></rect><g id="mermaid-svgText" transform="translate(0, -109.5)" class="label"><g transform="translate(-106.6484375,-14)"><foreignObject height="28" width="213.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="font-size:24px">mlp          </span></div></foreignObject></g></g></g></g><g class="edgePaths"><g style="opacity: 1;" id="L-resid_pre-D" class="edgePath LS-resid_pre LE-D"><path style="fill:none" marker-end="url(#arrowhead364)" d="M143.11328125,94.15053001530525L130.21223958333334,100.37544167942104C117.31119791666667,106.60035334353684,91.50911458333333,119.05017667176843,78.60807291666667,131.0250883358842C65.70703125,143,65.70703125,154.5,65.70703125,169.75C65.70703125,185,65.70703125,204,65.70703125,224.58333333333334C65.70703125,245.16666666666666,65.70703125,267.3333333333333,65.70703125,289.5C65.70703125,311.6666666666667,65.70703125,333.8333333333333,65.70703125,354.4166666666667C65.70703125,375,65.70703125,394,65.70703125,409.25C65.70703125,424.5,65.70703125,436,65.70703125,447.5C65.70703125,459,65.70703125,470.5,65.70703125,485.75C65.70703125,501,65.70703125,520,65.70703125,539C65.70703125,558,65.70703125,577,65.70703125,592.25C65.70703125,607.5,65.70703125,619,65.70703125,632.0833333333334C65.70703125,645.1666666666666,65.70703125,659.8333333333334,65.70703125,678.25C65.70703125,696.6666666666666,65.70703125,718.8333333333334,65.70703125,741C65.70703125,763.1666666666666,65.70703125,785.3333333333334,65.70703125,807.5C65.70703125,829.6666666666666,65.70703125,851.8333333333334,65.70703125,872.4166666666666C65.70703125,893,65.70703125,912,65.70703125,925.6666666666666C65.70703125,939.3333333333334,65.70703125,947.6666666666666,65.70703125,957.5833333333334C65.70703125,967.5,65.70703125,979,65.70703125,995.8333333333334C65.70703125,1012.6666666666666,65.70703125,1034.8333333333333,65.70703125,1057C65.70703125,1079.1666666666667,65.70703125,1101.3333333333333,65.70703125,1123.5C65.70703125,1145.6666666666667,65.70703125,1167.8333333333333,65.70703125,1188.4166666666667C65.70703125,1209,65.70703125,1228,65.70703125,1243.25C65.70703125,1258.5,65.70703125,1270,65.70703125,1286.8333333333333C65.70703125,1303.6666666666667,65.70703125,1325.8333333333333,65.70703125,1346.4166666666667C65.70703125,1367,65.70703125,1386,108.31380208333333,1399.6666666666667C150.92057291666666,1413.3333333333333,236.13411458333334,1421.6666666666667,278.7408854166667,1425.8333333333333L321.34765625,1430" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead364"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g><g style="opacity: 1;" id="L-D-resid_mid" class="edgePath LS-D LE-resid_mid"><path style="fill:none" marker-end="url(#arrowhead365)" d="M321.34765625,1430L321.34765625,1435.75C321.34765625,1441.5,321.34765625,1453,321.34765625,1464.5C321.34765625,1476,321.34765625,1487.5,321.34765625,1493.25L321.34765625,1499" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead365"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-resid_mid-E" class="edgePath LS-resid_mid LE-E"><path style="fill:none" marker-end="url(#arrowhead366)" d="M260.93359375,1546.7155583399547L228.39583333333334,1555.179631949962C195.85807291666666,1563.6437055599697,130.78255208333334,1580.5718527799847,98.24479166666667,1594.7859263899925C65.70703125,1609,65.70703125,1620.5,65.70703125,1635.75C65.70703125,1651,65.70703125,1670,65.70703125,1690.5833333333333C65.70703125,1711.1666666666667,65.70703125,1733.3333333333333,65.70703125,1755.5C65.70703125,1777.6666666666667,65.70703125,1799.8333333333333,65.70703125,1820.4166666666667C65.70703125,1841,65.70703125,1860,65.70703125,1875.25C65.70703125,1890.5,65.70703125,1902,65.70703125,1913.5C65.70703125,1925,65.70703125,1936.5,65.70703125,1951.75C65.70703125,1967,65.70703125,1986,65.70703125,2006.5833333333333C65.70703125,2027.1666666666667,65.70703125,2049.3333333333335,65.70703125,2071.5C65.70703125,2093.6666666666665,65.70703125,2115.8333333333335,65.70703125,2136.4166666666665C65.70703125,2157,65.70703125,2176,65.70703125,2191.25C65.70703125,2206.5,65.70703125,2218,65.70703125,2234.8333333333335C65.70703125,2251.6666666666665,65.70703125,2273.8333333333335,65.70703125,2294.4166666666665C65.70703125,2315,65.70703125,2334,108.31380208333333,2347.6666666666665C150.92057291666666,2361.3333333333335,236.13411458333334,2369.6666666666665,278.7408854166667,2373.8333333333335L321.34765625,2378" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead366"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g><g style="opacity: 1;" id="L-E-resid_post" class="edgePath LS-E LE-resid_post"><path style="fill:none" marker-end="url(#arrowhead367)" d="M321.34765625,2378L321.34765625,2383.75C321.34765625,2389.5,321.34765625,2401,321.34765625,2412.5C321.34765625,2424,321.34765625,2435.5,321.34765625,2441.25L321.34765625,2447" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead367"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-resid_pre-scale" class="edgePath LS-resid_pre LE-scale"><path style="fill:none" marker-end="url(#arrowhead368)" d="M263.94140625,85.95450470640968L285.8268229166667,93.54542058867473C307.7122395833333,101.1363364709398,351.4830729166667,116.3181682354699,373.3684895833333,129.65908411773495C395.25390625,143,395.25390625,154.5,395.25390625,164.41666666666666C395.25390625,174.33333333333334,395.25390625,182.66666666666666,395.25390625,186.83333333333334L395.25390625,191" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead368"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-scale-normalized" class="edgePath LS-scale LE-normalized"><path style="fill:none" marker-end="url(#arrowhead369)" d="M395.25390625,255L395.25390625,260.75C395.25390625,266.5,395.25390625,278,395.25390625,289.5C395.25390625,301,395.25390625,312.5,395.25390625,318.25L395.25390625,324" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead369"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-normalized-v" class="edgePath LS-normalized LE-v"><path style="fill:none" marker-end="url(#arrowhead370)" d="M334.83984375,375.13859580565327L314.9205729166667,381.44882983804445C295.0013020833333,387.7590638704355,255.16276041666666,400.37953193521776,235.24348958333334,412.43976596760893C215.32421875,424.5,215.32421875,436,215.32421875,447.5C215.32421875,459,215.32421875,470.5,215.32421875,485.75C215.32421875,501,215.32421875,520,215.32421875,539C215.32421875,558,215.32421875,577,215.32421875,592.25C215.32421875,607.5,215.32421875,619,215.32421875,632.0833333333334C215.32421875,645.1666666666666,215.32421875,659.8333333333334,215.32421875,678.25C215.32421875,696.6666666666666,215.32421875,718.8333333333334,215.32421875,741C215.32421875,763.1666666666666,215.32421875,785.3333333333334,215.32421875,802.1666666666666C215.32421875,819,215.32421875,830.5,215.32421875,836.25L215.32421875,842" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead370"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-v-G" class="edgePath LS-v LE-G"><path style="fill:none" marker-end="url(#arrowhead371)" d="M215.32421875,906L215.32421875,910.1666666666666C215.32421875,914.3333333333334,215.32421875,922.6666666666666,245.61263020833334,931C275.9010416666667,939.3333333333334,336.4778645833333,947.6666666666666,366.7662760416667,951.8333333333334L397.0546875,956" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead371"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g><g style="opacity: 1;" id="L-G-z" class="edgePath LS-G LE-z"><path style="fill:none" marker-end="url(#arrowhead372)" d="M397.0546875,956L397.0546875,961.75C397.0546875,967.5,397.0546875,979,397.0546875,990.5C397.0546875,1002,397.0546875,1013.5,397.0546875,1019.25L397.0546875,1025" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead372"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-z-result" class="edgePath LS-z LE-result"><path style="fill:none" marker-end="url(#arrowhead373)" d="M397.0546875,1089L397.0546875,1094.75C397.0546875,1100.5,397.0546875,1112,397.0546875,1123.5C397.0546875,1135,397.0546875,1146.5,397.0546875,1152.25L397.0546875,1158" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead373"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-result-attn_out" class="edgePath LS-result LE-attn_out"><path style="fill:none" marker-end="url(#arrowhead374)" d="M397.0546875,1222L397.0546875,1226.1666666666667C397.0546875,1230.3333333333333,397.0546875,1238.6666666666667,397.0546875,1248.5833333333333C397.0546875,1258.5,397.0546875,1270,397.0546875,1281.5C397.0546875,1293,397.0546875,1304.5,397.0546875,1310.25L397.0546875,1316" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead374"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-attn_out-D" class="edgePath LS-attn_out LE-D"><path style="fill:none" marker-end="url(#arrowhead375)" d="M397.0546875,1380L397.0546875,1384.1666666666667C397.0546875,1388.3333333333333,397.0546875,1396.6666666666667,384.4368489583333,1405C371.8190104166667,1413.3333333333333,346.5833333333333,1421.6666666666667,333.9654947916667,1425.8333333333333L321.34765625,1430" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead375"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g><g style="opacity: 1;" id="L-normalized-q" class="edgePath LS-normalized LE-q"><path style="fill:none" marker-end="url(#arrowhead376)" d="M395.25390625,388L395.25390625,392.1666666666667C395.25390625,396.3333333333333,395.25390625,404.6666666666667,395.25390625,414.5833333333333C395.25390625,424.5,395.25390625,436,395.25390625,447.5C395.25390625,459,395.25390625,470.5,395.25390625,480.4166666666667C395.25390625,490.3333333333333,395.25390625,498.6666666666667,395.25390625,502.8333333333333L395.25390625,507" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead376"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-q-F" class="edgePath LS-q LE-F"><path style="fill:none" marker-end="url(#arrowhead377)" d="M395.25390625,571L395.25390625,575.1666666666666C395.25390625,579.3333333333334,395.25390625,587.6666666666666,414.890625,597.5833333333334C434.52734375,607.5,473.80078125,619,493.4375,624.75L513.07421875,630.5" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead377"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g><g style="opacity: 1;" id="L-F-attn_scores" class="edgePath LS-F LE-attn_scores"><path style="fill:none" marker-end="url(#arrowhead378)" d="M513.07421875,630.5L513.07421875,637.8333333333334C513.07421875,645.1666666666666,513.07421875,659.8333333333334,513.07421875,672.9166666666666C513.07421875,686,513.07421875,697.5,513.07421875,703.25L513.07421875,709" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead378"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-attn_scores-pattern" class="edgePath LS-attn_scores LE-pattern"><path style="fill:none" marker-end="url(#arrowhead379)" d="M513.07421875,773L513.07421875,778.75C513.07421875,784.5,513.07421875,796,513.07421875,807.5C513.07421875,819,513.07421875,830.5,513.07421875,836.25L513.07421875,842" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead379"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-pattern-G" class="edgePath LS-pattern LE-G"><path style="fill:none" marker-end="url(#arrowhead380)" d="M513.07421875,906L513.07421875,910.1666666666666C513.07421875,914.3333333333334,513.07421875,922.6666666666666,493.7376302083333,931C474.4010416666667,939.3333333333334,435.7278645833333,947.6666666666666,416.3912760416667,951.8333333333334L397.0546875,956" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead380"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g><g style="opacity: 1;" id="L-normalized-k" class="edgePath LS-normalized LE-k"><path style="fill:none" marker-end="url(#arrowhead381)" d="M455.66796875,370.6137855579869L484.8723958333333,377.6781546316558C514.0768229166666,384.7425237053246,572.4856770833334,398.87126185266226,601.6901041666666,411.68563092633116C630.89453125,424.5,630.89453125,436,630.89453125,447.5C630.89453125,459,630.89453125,470.5,630.89453125,480.4166666666667C630.89453125,490.3333333333333,630.89453125,498.6666666666667,630.89453125,502.8333333333333L630.89453125,507" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead381"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-k-F" class="edgePath LS-k LE-F"><path style="fill:none" marker-end="url(#arrowhead382)" d="M630.89453125,571L630.89453125,575.1666666666666C630.89453125,579.3333333333334,630.89453125,587.6666666666666,611.2578125,597.5833333333334C591.62109375,607.5,552.34765625,619,532.7109375,624.75L513.07421875,630.5" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead382"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g><g style="opacity: 1;" id="L-resid_mid-scale2" class="edgePath LS-resid_mid LE-scale2"><path style="fill:none" marker-end="url(#arrowhead383)" d="M352.58073895676694,1563L358.19293350563913,1568.75C363.8051280545113,1574.5,375.02951715225566,1586,380.64171170112786,1597.5C386.25390625,1609,386.25390625,1620.5,386.25390625,1630.4166666666667C386.25390625,1640.3333333333333,386.25390625,1648.6666666666667,386.25390625,1652.8333333333333L386.25390625,1657" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead383"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-scale2-normalized2" class="edgePath LS-scale2 LE-normalized2"><path style="fill:none" marker-end="url(#arrowhead384)" d="M386.25390625,1721L386.25390625,1726.75C386.25390625,1732.5,386.25390625,1744,386.25390625,1755.5C386.25390625,1767,386.25390625,1778.5,386.25390625,1784.25L386.25390625,1790" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead384"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-normalized2-pre" class="edgePath LS-normalized2 LE-pre"><path style="fill:none" marker-end="url(#arrowhead385)" d="M386.25390625,1854L386.25390625,1858.1666666666667C386.25390625,1862.3333333333333,386.25390625,1870.6666666666667,386.25390625,1880.5833333333333C386.25390625,1890.5,386.25390625,1902,386.25390625,1913.5C386.25390625,1925,386.25390625,1936.5,386.25390625,1946.4166666666667C386.25390625,1956.3333333333333,386.25390625,1964.6666666666667,386.25390625,1968.8333333333333L386.25390625,1973" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead385"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-pre-post" class="edgePath LS-pre LE-post"><path style="fill:none" marker-end="url(#arrowhead386)" d="M386.25390625,2037L386.25390625,2042.75C386.25390625,2048.5,386.25390625,2060,386.25390625,2071.5C386.25390625,2083,386.25390625,2094.5,386.25390625,2100.25L386.25390625,2106" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead386"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-post-mlp_out" class="edgePath LS-post LE-mlp_out"><path style="fill:none" marker-end="url(#arrowhead387)" d="M386.25390625,2170L386.25390625,2174.1666666666665C386.25390625,2178.3333333333335,386.25390625,2186.6666666666665,386.25390625,2196.5833333333335C386.25390625,2206.5,386.25390625,2218,386.25390625,2229.5C386.25390625,2241,386.25390625,2252.5,386.25390625,2258.25L386.25390625,2264" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead387"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowheadPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker></defs></g><g style="opacity: 1;" id="L-mlp_out-E" class="edgePath LS-mlp_out LE-E"><path style="fill:none" marker-end="url(#arrowhead388)" d="M386.25390625,2328L386.25390625,2332.1666666666665C386.25390625,2336.3333333333335,386.25390625,2344.6666666666665,375.4361979166667,2353C364.6184895833333,2361.3333333333335,342.9830729166667,2369.6666666666665,332.1653645833333,2373.8333333333335L321.34765625,2378" class="path"></path><defs><marker orient="auto" markerHeight="6" markerWidth="8" markerUnits="strokeWidth" refY="5" refX="9" viewBox="0 0 10 10" id="arrowhead388"><path style="fill: #333" d="M 0 0 L 0 0 L 0 0 z"></path></marker></defs></g></g><g class="edgeLabels"><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-resid_pre' L-LE-D" id="L-L-resid_pre-D"></span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(321.34765625,1464.5)" class="edgeLabel"><g class="label" transform="translate(-13.1171875,-9.5)"><rect height="19" width="26.234375" ry="0" rx="0"></rect><foreignObject height="19" width="26.234375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-D' L-LE-resid_mid" id="L-L-D-resid_mid">add</span></div></foreignObject></g></g><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-resid_mid' L-LE-E" id="L-L-resid_mid-E"></span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(321.34765625,2412.5)" class="edgeLabel"><g class="label" transform="translate(-13.1171875,-9.5)"><rect height="19" width="26.234375" ry="0" rx="0"></rect><foreignObject height="19" width="26.234375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-E' L-LE-resid_post" id="L-L-E-resid_post">add</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(395.25390625,131.5)" class="edgeLabel"><g class="label" transform="translate(-102.8671875,-9.5)"><rect height="19" width="205.734375" ry="0" rx="0"></rect><foreignObject height="19" width="205.734375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-resid_pre' L-LE-scale" id="L-L-resid_pre-scale">subtract mean, divide by std</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(395.25390625,289.5)" class="edgeLabel"><g class="label" transform="translate(-38.4765625,-9.5)"><rect height="19" width="76.953125" ry="0" rx="0"></rect><foreignObject height="19" width="76.953125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-scale' L-LE-normalized" id="L-L-scale-normalized">W_ln, b_ln</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(215.32421875,630.5)" class="edgeLabel"><g class="label" transform="translate(-33.2421875,-9.5)"><rect height="19" width="66.484375" ry="0" rx="0"></rect><foreignObject height="19" width="66.484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-normalized' L-LE-v" id="L-L-normalized-v">W_V, b_V</span></div></foreignObject></g></g><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-v' L-LE-G" id="L-L-v-G"></span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(397.0546875,990.5)" class="edgeLabel"><g class="label" transform="translate(-107.2734375,-9.5)"><rect height="19" width="214.546875" ry="0" rx="0"></rect><foreignObject height="19" width="214.546875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-G' L-LE-z" id="L-L-G-z">weighted avg of value vectors</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(397.0546875,1123.5)" class="edgeLabel"><g class="label" transform="translate(-16.40625,-9.5)"><rect height="19" width="32.8125" ry="0" rx="0"></rect><foreignObject height="19" width="32.8125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-z' L-LE-result" id="L-L-z-result">W_O</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(397.0546875,1281.5)" class="edgeLabel"><g class="label" transform="translate(-106.8984375,-9.5)"><rect height="19" width="213.796875" ry="0" rx="0"></rect><foreignObject height="19" width="213.796875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-result' L-LE-attn_out" id="L-L-result-attn_out">sum over heads, add bias b_O</span></div></foreignObject></g></g><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-attn_out' L-LE-D" id="L-L-attn_out-D"></span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(395.25390625,447.5)" class="edgeLabel"><g class="label" transform="translate(-35.828125,-9.5)"><rect height="19" width="71.65625" ry="0" rx="0"></rect><foreignObject height="19" width="71.65625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-normalized' L-LE-q" id="L-L-normalized-q">W_Q, b_Q</span></div></foreignObject></g></g><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-q' L-LE-F" id="L-L-q-F"></span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(513.07421875,674.5)" class="edgeLabel"><g class="label" transform="translate(-151.703125,-9.5)"><rect height="19" width="303.40625" ry="0" rx="0"></rect><foreignObject height="19" width="303.40625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-F' L-LE-attn_scores" id="L-L-F-attn_scores">dot product along d_head, scale and mask</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(513.07421875,807.5)" class="edgeLabel"><g class="label" transform="translate(-28.515625,-9.5)"><rect height="19" width="57.03125" ry="0" rx="0"></rect><foreignObject height="19" width="57.03125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-attn_scores' L-LE-pattern" id="L-L-attn_scores-pattern">softmax</span></div></foreignObject></g></g><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-pattern' L-LE-G" id="L-L-pattern-G"></span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(630.89453125,447.5)" class="edgeLabel"><g class="label" transform="translate(-34.2265625,-9.5)"><rect height="19" width="68.453125" ry="0" rx="0"></rect><foreignObject height="19" width="68.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-normalized' L-LE-k" id="L-L-normalized-k">W_K, b_K</span></div></foreignObject></g></g><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-k' L-LE-F" id="L-L-k-F"></span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(386.25390625,1597.5)" class="edgeLabel"><g class="label" transform="translate(-102.8671875,-9.5)"><rect height="19" width="205.734375" ry="0" rx="0"></rect><foreignObject height="19" width="205.734375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-resid_mid' L-LE-scale2" id="L-L-resid_mid-scale2">subtract mean, divide by std</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(386.25390625,1755.5)" class="edgeLabel"><g class="label" transform="translate(-38.4765625,-9.5)"><rect height="19" width="76.953125" ry="0" rx="0"></rect><foreignObject height="19" width="76.953125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-scale2' L-LE-normalized2" id="L-L-scale2-normalized2">W_ln, b_ln</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(386.25390625,1913.5)" class="edgeLabel"><g class="label" transform="translate(-38.3203125,-9.5)"><rect height="19" width="76.640625" ry="0" rx="0"></rect><foreignObject height="19" width="76.640625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-normalized2' L-LE-pre" id="L-L-normalized2-pre">W_in, b_in</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(386.25390625,2071.5)" class="edgeLabel"><g class="label" transform="translate(-22.859375,-9.5)"><rect height="19" width="45.71875" ry="0" rx="0"></rect><foreignObject height="19" width="45.71875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-pre' L-LE-post" id="L-L-pre-post">act_fn</span></div></foreignObject></g></g><g style="opacity: 1;" transform="translate(386.25390625,2229.5)" class="edgeLabel"><g class="label" transform="translate(-48.6875,-9.5)"><rect height="19" width="97.375" ry="0" rx="0"></rect><foreignObject height="19" width="97.375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-post' L-LE-mlp_out" id="L-L-post-mlp_out">W_out, b_out</span></div></foreignObject></g></g><g style="opacity: 1;" transform="" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect height="0" width="0" ry="0" rx="0"></rect><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span style="" class="edgeLabel L-LS-mlp_out' L-LE-E" id="L-L-mlp_out-E"></span></div></foreignObject></g></g></g><g class="nodes"><g style="opacity: 1;" transform="translate(321.34765625,2479)" id="flowchart-resid_post-100" class="node default"><rect class="label-container" height="64" width="120.828125" y="-32" x="-60.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-50.4140625,-22)"><foreignObject height="44" width="100.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">resid_post<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(321.34765625,2378)" id="flowchart-E-99" class="node empty"><rect class="label-container" height="20" width="20" y="-10" x="-10" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(0,0)"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(321.34765625,1531)" id="flowchart-resid_mid-98" class="node default"><rect class="label-container" height="64" width="120.828125" y="-32" x="-60.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-50.4140625,-22)"><foreignObject height="44" width="100.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">resid_mid<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(321.34765625,1430)" id="flowchart-D-97" class="node empty"><rect class="label-container" height="20" width="20" y="-10" x="-10" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(0,0)"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(203.52734375,65)" id="flowchart-resid_pre-96" class="node default"><rect class="label-container" height="64" width="120.828125" y="-32" x="-60.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-50.4140625,-22)"><foreignObject height="44" width="100.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">resid_pre<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(397.0546875,1348)" id="flowchart-attn_out-120" class="node default"><rect class="label-container" height="64" width="120.828125" y="-32" x="-60.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-50.4140625,-22)"><foreignObject height="44" width="100.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">attn_out<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(386.25390625,2296)" id="flowchart-mlp_out-142" class="node default"><rect class="label-container" height="64" width="120.828125" y="-32" x="-60.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-50.4140625,-22)"><foreignObject height="44" width="100.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">mlp_out<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(386.25390625,2005)" id="flowchart-pre-137" class="node default"><rect class="label-container" height="64" width="149.625" y="-32" x="-74.8125" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-64.8125,-22)"><foreignObject height="44" width="129.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">pre<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, 4 * d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(386.25390625,2138)" id="flowchart-post-138" class="node default"><rect class="label-container" height="64" width="149.625" y="-32" x="-74.8125" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-64.8125,-22)"><foreignObject height="44" width="129.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">post<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, 4 * d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(386.25390625,1689)" id="flowchart-scale2-131" class="node default"><rect class="label-container" height="64" width="77.609375" y="-32" x="-38.8046875" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-28.8046875,-22)"><foreignObject height="44" width="57.609375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">scale<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, 1)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(386.25390625,1822)" id="flowchart-normalized2-132" class="node default"><rect class="label-container" height="64" width="120.828125" y="-32" x="-60.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-50.4140625,-22)"><foreignObject height="44" width="100.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">normalized<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(215.32421875,874)" id="flowchart-v-106" class="node default"><rect class="label-container" height="64" width="185.640625" y="-32" x="-92.8203125" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-82.8203125,-22)"><foreignObject height="44" width="165.640625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">v<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, head_idx, d_head)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(395.25390625,539)" id="flowchart-q-107" class="node default"><rect class="label-container" height="64" width="185.640625" y="-32" x="-92.8203125" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-82.8203125,-22)"><foreignObject height="44" width="165.640625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">q<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, head_idx, d_head)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(630.89453125,539)" id="flowchart-k-108" class="node default"><rect class="label-container" height="64" width="185.640625" y="-32" x="-92.8203125" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-82.8203125,-22)"><foreignObject height="44" width="165.640625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">k<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, head_idx, d_head)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(513.07421875,741)" id="flowchart-attn_scores-109" class="node default"><rect class="label-container" height="64" width="178.4375" y="-32" x="-89.21875" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-79.21875,-22)"><foreignObject height="44" width="158.4375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">attn_scores<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(head_idx, seqQ, seqK)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(513.07421875,630.5)" id="flowchart-F-110" class="node empty"><rect class="label-container" height="20" width="20" y="-10" x="-10" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(0,0)"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(513.07421875,874)" id="flowchart-pattern-111" class="node default"><rect class="label-container" height="64" width="178.4375" y="-32" x="-89.21875" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-79.21875,-22)"><foreignObject height="44" width="158.4375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">pattern<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(head_idx, seqQ, seqK)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(397.0546875,956)" id="flowchart-G-112" class="node empty"><rect class="label-container" height="20" width="20" y="-10" x="-10" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(0,0)"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(397.0546875,1057)" id="flowchart-z-113" class="node default"><rect class="label-container" height="64" width="185.640625" y="-32" x="-92.8203125" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-82.8203125,-22)"><foreignObject height="44" width="165.640625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">z<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, head_idx, d_head)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(397.0546875,1190)" id="flowchart-result-114" class="node default"><rect class="label-container" height="64" width="192.828125" y="-32" x="-96.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-86.4140625,-22)"><foreignObject height="44" width="172.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">result<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, head_idx, d_model)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(395.25390625,223)" id="flowchart-scale-101" class="node default"><rect class="label-container" height="64" width="77.609375" y="-32" x="-38.8046875" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-28.8046875,-22)"><foreignObject height="44" width="57.609375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">scale<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, 1)</code></div></foreignObject></g></g></g><g style="opacity: 1;" transform="translate(395.25390625,356)" id="flowchart-normalized-102" class="node default"><rect class="label-container" height="64" width="120.828125" y="-32" x="-60.4140625" ry="0" rx="0"></rect><g transform="translate(0,0)" class="label"><g transform="translate(-50.4140625,-22)"><foreignObject height="44" width="100.828125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml">normalized<div style="border-top:2px solid black;margin-top:4px"></div><code style="color:red;font-size:12px">(seq, d_model)</code></div></foreignObject></g></g></g></g></g></g><style>@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css");</style></svg>
